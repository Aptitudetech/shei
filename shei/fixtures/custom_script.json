[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Customer", 
  "modified": "2017-11-15 12:28:25.544737", 
  "name": "Customer-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "frappe.ui.form.on(\"Customer\", \"refresh\", function(){\n    cur_frm.add_custom_button(\"Sales History\", function(){\n        frappe.route_options = {'customer': cur_frm.doc.name};\n        frappe.set_route(\"List\", \"Sales History\");\n    });\n});\n\nfrappe.ui.form.on(\"Customer\", \"default_currency\", function(frm, cdt, cdn) {\n\tif(frm.doc.default_currency == \"USD\") {\n\t\tfrm.doc.accounts = [];\n\t\tvar row = frappe.model.add_child(cur_frm.doc, \"Party Account\", \"accounts\");\n\t\trow.company = \"SH Environnements Immersifs\";\n\t\trow.account = \"12150 COMPTES CLIENTS US (ERP) - SHI\";\t\t\t\n\t} else {\n\t\tfrm.doc.accounts = [];\n\t}\n\trefresh_field(\"accounts\");\n});\n\n$.extend(erpnext.utils, {\n        set_party_dashboard_indicators: function(frm){\n                if (frm.doc.__onload && frm.doc.__onload.dashboard_info){\n                        var info = frm.doc.__onload.dashboard_info;\n                        frm.dashboard.add_indicator(__('Last Year Billing: {0}',\n                                [format_currency(info.billing_last_year, info.currency)]), 'blue')\n\t\t\tfrm.dashboard.add_indicator(__('This Year Billing: {0}',\n                                [format_currency(info.billing_this_year, info.currency)]), 'blue')\n                        frm.dashboard.add_indicator(__('Total Unpaid: {0}',\n                                [format_currency(info.total_unpaid, info.currency)]),\n                                info.total_unpaid ? 'orange': 'green');\n                }\n        }\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Quotation", 
  "modified": "2019-06-28 09:43:53.231085", 
  "name": "Quotation-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "\nfrappe.ui.form.on(cur_frm.doctype, {\n    display_lost_reason: function(frm){\n        let dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Set as Lost\"),\n\t\t\tfields: [\n                                {\"fieldname\": 'lost_reason', 'fieldtype': 'Link',  'options': 'Lost Reason', 'reqd': 1},\n\t\t\t\t{'fieldname': 'other_reason', fieldtype: 'Small Text', label: __('Other Reason'), 'depends_on': \"eval:doc.lost_reason === 'RL0008'\"}\n\t\t\t],\n\t\t\tprimary_action: function() {\n\t\t\t\tvar values = dialog.get_values();\n\t\t\t\tlet reason_description = frappe.db.get_value(\"Lost Reason\", values[\"lost_reason\"], 'lost_reason');\n\t\t\t\t\n\t\t\t\treason_description.then(function(value){\n\t\t\t\t\tlet lost_reason = value['message']['lost_reason']\n\t\t\t\t\tlet full_reason = lost_reason;\n\t\t\t\t\tif(values[\"lost_reason\"] == 'RL0008'){\n\t\t\t\t\t\tif(values[\"other_reason\"] == null ){\n\t\t\t\t\t\t\tfrappe.throw(\"You must write a reason before proceeding\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tfull_reason = full_reason + \" - \" + values[\"other_reason\"];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfrm.call({\n\t\t\t\t\t\tmethod: 'declare_order_lost',\n\t\t\t\t\t\tdoc: frm.doc,\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t'reason': full_reason\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcallback: function(r) {\n\t\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\t\tfrm.reload_doc();\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\trefresh_field(\"quote_lost_reason\");\n\t\t\t\t});\n\t\t\t},\n\t\t\tprimary_action_label: __('Declare Lost')\n\t\t});\n\n\t\tdialog.show();\n\t\tdialog.get_input('lost_reason').on('awesomplete-selectcomplete', function(e){\n\t\t\tsetTimeout(function(){\n        \t\t\tdialog.refresh();\n    \t\t\t}, 500);\n\t\t});\n    }\n});\n\n//Will overwrite the QuotationController - used to change 'Set as lost' button behavior\nerpnext.selling.CustomQuotationController = erpnext.selling.QuotationController.extend({\n    refresh: function(doc, dt, dn) {\n\t\tthis._super(doc, dt, dn);\n\t\t//the button should only be available if the quote is 'Submit'\n\t\tif(doc.docstatus == 1 && doc.status!=='Lost') {\n\t\t\tif(doc.status!==\"Ordered\") {\n\t\t\t\tthis.frm.remove_custom_button(__('Set as Lost'));\n\t\t\t\tthis.frm.add_custom_button(__('Set as Lost'), () => {\n\t\t\t\t\tthis.frm.trigger('display_lost_reason');\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n});\ncur_frm.script_manager.make(erpnext.selling.CustomQuotationController);\n\n/* frappe.ui.form.on('Quotation', 'refresh', function(frm, cdt, cdn){\n\tif (!frm.doc.__islocal){\n\t\tdashboard_link_doctype(frm, 'Product Configurator', __('Sales Order'), {  //sales order = where the link should be displayed\n\t\t\t'fieldname': 'quote',\n\t\t\t'transactions': [\n\t\t\t\t{\n\t\t\t\t\t'items': ['Product Configurator'],\n\t\t\t\t\t'label': __('Product Configurator')\n\t\t\t\t}]\n\t\t});\n\t}\n});\n\nfunction dashboard_link_doctype(frm, doctype, section, links){\n\tdebugger;\n\tvar parent = $(format('.form-dashboard-wrapper h6:contains(\"{}\")', [section])).parent();\n\tparent.find(format('div.document-link[data-doctype=\"{}\"]', [doctype])).remove();\n\tparent.append(frappe.render_template('dashboard_link_doctype', {'doctype': doctype}));\n\tvar self = parent.find(format('div.document-link[data-doctype=\"{}\"]', [doctype]));\n\tset_open_count(frm, doctype, links);\n\t// bind links\n\tself.find('.badge-link').on('click', function(){\n\t\tvar routes = {};\n\t\troutes[frappe.scrub(frm.doc.doctype)] = frm.doc.name;\n\t\tfrappe.route_options = routes;\n\t\tfrappe.set_route('List', doctype);\n\t});\n\n\t// bind open notifications\n\tself.find('.open-notification').on('click', function() {\n\t\tfrappe.route_options = {\n\t\t\t'product_configurator': frm.doc.name//,\n\t\t\t//'status': 'Draft'\n\t\t};\n\t\tfrappe.set_route('List', doctype);\n\t});\n}\n\nfunction set_open_count (frm, doctype, links){\n\tfrappe.call({\n\t\t'method': 'shei.api.get_open_count',\n\t\t'args': {\n\t\t\t'doctype': frm.doctype,\n\t\t\t'name': frm.docname,\n\t\t\t'links': links\n\t\t},\n\t\t'callback': function(res){\n\t\t\t// update badges\n\t\t\tif (res && res.message){\n\t\t\t\tres.message.count.forEach(function(d){\n\t\t\t\t\tfrm.dashboard.set_badge_count(\n\t\t\t\t\t\td.name, cint(d.open_count), cint(d.count)\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n}\n*/\n\n\n\n\n\n\n\n    frappe.ui.form.on(\"Quotation\", \"customer_deposit\", function(frm, cdt, cdn) {\n\tif(frm.doc.customer_deposit == 1)\n\t\t{\n\t\tfrappe.model.set_value(cdt, cdn, \"naming_series\", \"PFI-\");\n\t}\n\telse\n\t\t{\n\t\tfrappe.model.set_value(cdt, cdn, \"naming_series\", \"QTN-\");\n\t}\n});\n\nfrappe.ui.form.on(\"Quotation\", \"customer\", function(frm, cdt, cdn) {\n\tfrappe.db.get_value(\"Customer\", frm.doc.customer, \"tc_name\", function(r){\n\t\tif(r.tc_name) {\n\t\t\tfrappe.model.set_value(cdt, cdn, \"tc_name\", r.tc_name);\t\t\t\n\t\t}\n\t});\n\trefresh_field(\"tc_name\");\n}); \n\nfrappe.ui.form.on(\"Quotation\", \"refresh\", function(frm, cdt, cdn) {\n\n        frm.add_custom_button(__(\"Update Item Description\"), function() {\n\t\tfrappe.call({\n\t\t\tmethod: \"multilingual_extension.item_description.update_item_description\",\n\t\t\targs: {\n\t\t\t\tcustomer: frm.doc.party_name,\n\t\t\t\tdocType: \"Quotation\",\n\t\t\t\tdocName: frm.doc.name,\n\t\t\t},\n\t    \t\tcallback: function(r) {\n\t\t\t\tcur_frm.reload_doc();\n      \t\t\t}\n\t\t})\n\t});\n});\n\n//frappe.ui.form.on(\"Quotation Item\", \"item_code\", function(frm, cdt, cdn) {\n//\tct = locals[cdt][cdn]\n//\tfrappe.after_ajax(function() {\n//\t\tfrappe.call({\n//\t\t\tmethod: \"multilingual_extension.item_description.fetch_item_description\",\n//\t\t\targs:{\n//\t\t\t\tcustomer_code: frm.doc.customer,\n//\t\t\t\titem_code: ct.item_code,\n//\t\t\t\t},\n//            \tcallback: function(r) {\n//\t\t\tfrappe.model.set_value(cdt, cdn, \"description\", r.message);\n//\t\t\t}\n//        \t})\n//\t});\n//});\n\n//frappe.ui.form.on(\"Quotation\", \"customer\", function(frm, cdt, cdn) {\n//\t\tfrappe.call({\n//\t\t\tmethod: \"multilingual_extension.get_terms_and_conditions.get_terms_and_conditions\",\n//\t\t\targs:{\n//\t\t\t\tcustomer_code: frm.doc.customer\n//\t\t\t\t},\n//            \tcallback: function(r) {\n//\t\t\tif (r.message != \" \") {\n//\t\t\t\tfrappe.model.set_value(cdt, cdn, \"tc_name\", r.message);\n//\t\t\t}\n//        \t    }\n//\t});\n//});\n\n//frappe.ui.form.on(\"Quotation\", \"validate\", function(frm, cdt, cdn){\n//\tif (frm.doc.customer_deposit && !frm.doc.project) {\n//\t\tmsgprint(__(\"Project is mandatory when Customer Deposit is selected\"));\n//\t\tvalidated = false;\n//\t}\n//});\n\nfrappe.ui.form.on(\"Quotation\", \"on_submit\", function(frm, cdt, cdn){\n\tif (frm.doc.customer_deposit && frm.doc.project) {\n\t\tfrappe.call({\n\t\t\tmethod: \"shei.sheipy.set_project_pfi\",\n\t\t\targs:{\n\t\t\t\tpfi: frm.doc.name,\n\t\t\t\taction: \"add\"\n\t\t\t},\n\t            \tcallback: function(r) {\n\t        \t}\n\t\t});\n\t}\n\tif (frm.doc.customer_deposit && !frm.doc.project) {\n\t\tfrappe.throw(__(\"Project is mandatory when Customer Deposit is selected\"));\n\t}\n});\n\nfrappe.ui.form.on(\"Quotation\", \"after_cancel\", function(frm, cdt, cdn){\n\tif (frm.doc.customer_deposit && frm.doc.project) {\n\t\tfrappe.call({\n\t\t\tmethod: \"shei.sheipy.set_project_pfi\",\n\t\t\targs:{\n\t\t\t\tpfi: frm.doc.name,\n\t\t\t\taction: \"remove\"\n\t\t\t},\n\t            \tcallback: function(r) {\n\t        \t}\n\t\t});\n\t}\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Invoice", 
  "modified": "2017-10-03 11:12:37.768523", 
  "name": "Sales Invoice-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "frappe.ui.form.on(\"Sales Invoice\", \"refresh\", function(frm, cdt, cdn) {\n        frm.add_custom_button(__(\"Update Item Description\"), function() {\n\t\tfrappe.call({\n\t\t\tmethod: \"multilingual_extension.item_description.update_item_description\",\n\t\t\targs: {\n\t\t\t\tcustomer: frm.doc.customer,\n\t\t\t\tdocType: \"Sales Invoice\",\n\t\t\t\tdocName: frm.doc.name,\n\t\t\t},\n\t    \t\tcallback: function(r) {\n\t\t\t\tcur_frm.reload_doc();\n      \t\t\t}\n\t\t})\n\t});\n});\n\nfrappe.ui.form.on(\"Sales Invoice\", \"customer\", function(frm, cdt, cdn) {\n\tfrappe.db.get_value(\"Customer\", frm.doc.customer, \"tc_name\", function(r){\n\t\tif(r.tc_name) {\n\t\t\tfrappe.model.set_value(cdt, cdn, \"tc_name\", r.tc_name);\t\t\t\n\t\t}\n\t});\n\trefresh_field(\"tc_name\");\n});\n\n//frappe.ui.form.on(\"Sales Invoice Item\", \"item_code\", function(frm, cdt, cdn) {\n//\tct = locals[cdt][cdn]\n//\tfrappe.after_ajax(function() {\n//\t\tfrappe.call({\n//\t\t\tmethod: \"multilingual_extension.item_description.fetch_item_description\",\n//\t\t\targs:{\n//\t\t\t\tcustomer_code: frm.doc.customer,\n//\t\t\t\titem_code: ct.item_code,\n//\t\t\t\t},\n//            \tcallback: function(r) {\n//\t\t\tfrappe.model.set_value(cdt, cdn, \"description\", r.message);\n//        \t    }\n//        \t})\n//\t});\n//});\n\n//frappe.ui.form.on(\"Sales Invoice\", \"customer\", function(frm, cdt, cdn) {\n//\t\tfrappe.call({\n//\t\t\tmethod: \"multilingual_extension.get_terms_and_conditions.get_terms_and_conditions\",\n//\t\t\targs:{\n//\t\t\t\tcustomer_code: frm.doc.customer\n//\t\t\t\t},\n//            \tcallback: function(r) {\n//\t\t\tif (r.message != \" \") {\n//\t\t\t\tfrappe.model.set_value(cdt, cdn, \"tc_name\", r.message);\n//\t\t\t}\n//        \t    }\n//\t});\n//});\n\n\nfrappe.ui.form.on(\"Sales Invoice\", \"get_credit_notes\", function(frm, cdt, cdn){\n    if (frm.doc.customer){\n\t\treturn frm.call({\n\t\t\t\"method\": \"shei.events.get_credit_notes\",\n\t\t\t\"args\": {\n\t\t\t\t\"doctype\": frm.doctype,\n\t\t\t\t\"party_type\": \"customer\",\n\t\t\t\t\"party_name\": frm.doc.customer\n\t\t\t},\n\t\t\t\"callback\": function(res){\n\t\t\t\tif (res && res.message){\n\t\t\t\t\tfrm.clear_table('credits');\n\t\t\t\t\tvar pending_amount = frm.doc.outstanding_amount, credits = 0.0;\n\t\t\t\t\tres.message.forEach(function(row){\n\t\t\t\t\t\tvar d = frm.add_child('credits', row);\n\t\t\t\t\t\tif (d.allocated_amount > pending_amount){\n\t\t\t\t\t\t\tfrappe.model.set_value(d.doctype, d.name,\n\t\t\t\t\t\t\t\t'allocated_amount', pending_amount);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpending_amount - d.allocated_amount;\n\t\t\t\t\t\tcredits += d.allocated_amount;\n\t\t\t\t\t});\n\t\t\t\t\tfrm.refresh_field(\"credits\");\n\t\t\t\t\tfrm.set_value(\"total_credits\", credits);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n});\n\nfrappe.ui.form.on(\"Sales Invoice\", \"on_submit\", function(frm, cdt, cdn){\n    frm.reload_doc();\n});\n\nfrappe.ui.form.on(\"Sales Invoice Credit Notes\", \"credits_remove\", function(frm, cdt, cdn){\n    frm.doc.total_credits = 0.0;\n    frm.doc.credits.forEach(function(row){\n      frm.doc.total_credits += row.allocated_amount;\n    });\n    frm.refresh_field(\"total_credits\");\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Payment Entry", 
  "modified": "2017-05-18 11:32:00.447638", 
  "name": "Payment Entry-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "frappe.ui.form.on(\"Payment Entry\", \"refresh\", function(frm, cdt, cdn) {\n        frm.add_custom_button(__(\"Reserve cheque number\"), function() {\n\t\tif(frm.doc.mode_of_payment == \"Cheque CDN\" || frm.doc.mode_of_payment == \"Cheque USD\"){\t\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"shei.advance_payment.get_cheque_series\",\n\t\t\t\targs: {\n\t\t\t\t\taccount: frm.doc.paid_from,\n\t\t\t\t},\n        \t    \t\tcallback: function(r) {\n\t\t\t\t\tfrappe.model.set_value(cdt, cdn, \"reference_no\", r.message);\n\t\t\t\t\t//frm.save()\n\t\t\t\t\t//cur_frm.reload_doc();\n        \t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmsgprint(\"You must select 'cheque' as a mode of payment to use this button\");\n\t\t}\n\t});\n\t\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Project", 
  "modified": "2019-06-27 17:40:32.875669", 
  "name": "Project-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "\nfrappe.ui.form.on('Crate Information', {\n    crate_gross_weight: function(frm, cdt, cdn){\n        var d = locals[cdt][cdn];\n        if (!d.crate_gross_weight) return;\n        frappe.model.set_value(cdt, cdn, 'crate_net_weight', d.crate_gross_weight - 100);\n    }\n});\nfrappe.ui.form.on(\"Project\", \"onload\", function(frm, cdt, cdn){\n\tfrappe.call({\n\t\tmethod: \"shei.sheipy.get_project_so\",\n\t\targs:{\n\t\t\tproject_name: frm.doc.name,\n\t\t},\n            \tcallback: function(r) {\n\t\t\tfrm.doc.project_amount_from_so = r.message;\n                        frm.refresh_field(\"project_amount_from_so\");\n                        frm.doc.__unsaved = false;\n                        frm.toolbar.refresh();\n        \t}\n\t});\n});\n\nfrappe.ui.form.on(\"Project\", \"customer\", function(frm, cdt, cdn) {\n\tif (frm.doc.customer) {\n\t\tfrappe.call({\n\t\t\tmethod: \"shei.sheipy.get_sales_person_from_customer\",\n\t\t\targs:{\n\t\t\t\tdt: cdt,\n\t\t\t\tcustomer_name: frm.doc.customer,\n\t\t\t\tproject: frm.doc.name,\n\t\t\t},\n        \t    \tcallback: function(r) {\n        \t\t}\n\t        });\n\t\tfrappe.call({\n\t\t\tmethod: \"shei.sheipy.change_project_name\",\n\t\t\targs:{\n\t\t\t\tdt: cdt,\n\t\t\t\tproject_name: frm.doc.name,\n\t\t\t\tcustomer_name: frm.doc.customer,\n\t\t\t},\n        \t    \tcallback: function(r) {\n\t\t\t\tif (r.message) {\n\t\t\t\t\tfrappe.set_route(\"Form\", \"Project\", r.message);\n\t\t\t\t}\n        \t\t}\n\t        });\n\t}\n});\n\nfrappe.ui.form.on(\"Project\", \"refresh\", function(frm, cdt, cdn) {\n\tif(frappe.user.has_role(['System Manager'])){\n//\t        frm.add_custom_button(__(\"Update Template Project\"), function() {\n//\t\t\tfrappe.call({\n//\t\t\t\tmethod: \"shei.sheipy.update_template_project\",\n//\t\t\t\targs: {\n//\t\t\t\t},\n//        \t    \t\tcallback: function(r) {\n//        \t\t\t}\n//\t\t\t});\n//\t\tfrm.refresh_field(\"project_amount_from_so\");\n//\t\t});\n//\t        frm.add_custom_button(__(\"Update Project Amount from SO\"), function() {\n//\t\t\tfrappe.call({\n//\t\t\t\tmethod: \"shei.sheipy.set_project_so\",\n//\t\t\t\targs: {\n//\t\t\t\t},\n//        \t    \t\tcallback: function(r) {\n//        \t\t\t}\n//\t\t\t});\n//\t\tfrm.refresh_field(\"project_amount_from_so\");\n//\t\t});\n//\t        frm.add_custom_button(__(\"Update Customer Deposit\"), function() {\n//\t\t\tfrappe.call({\n//\t\t\t\tmethod: \"shei.sheipy.set_project_customer_deposit\",\n//\t\t\t\targs: {\n//\t\t\t\t\tproject_name: \"all\",\n//\t\t\t\t},\n//        \t    \t\tcallback: function(r) {\n//        \t\t\t}\n//\t\t\t});\n//\t\tfrm.refresh();\n//\t\t});\n\t};\n//\tfrm.add_custom_button(__(\"Get Customer Deposit\"), function() {\n//\t\tfrappe.call({\n//\t\t\tmethod: \"shei.advance_payment.get_project_deposit\",\n//\t\t\targs:{\n//\t\t\t\tproject_name: frm.doc.name,\n//\t\t\t},\n//\t            \tcallback: function(r) {\n//\t\t\t\tcur_frm.reload_doc();\n//\t        \t}\n//\t\t});\n//\t});\n\tif (frm.doc.sub_type) {\n\t        frm.add_custom_button(__(\"Get Tasks from template\"), function() {\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"shei.sheipy.get_tasks_from_template\",\n\t\t\t\targs: {\n\t\t\t\t\tproject_name: frm.doc.name,\n\t\t\t\t},\n        \t    \t\tcallback: function(r) {\n        \t\t\t}\n\t\t\t});\n\t\tcur_frm.reload_doc();\n\t\t});\n\t}\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Purchase Invoice", 
  "modified": "2017-07-20 17:19:49.145028", 
  "name": "Purchase Invoice-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "frappe.ui.form.on(\"Purchase Invoice\", \"bill_date\", function(frm, cdt, cdn) {\n\tif (frm.doc.bill_date) {\n\t\tfrappe.call({\n\t\t\tmethod: \"shei.sheipy.get_due_date\",\n\t\t\targs:{\n\t\t\t\tsupplier: frm.doc.supplier,\n\t\t\t\tbill_date: frm.doc.bill_date\n\t\t\t},\n\t            \tcallback: function(r) {\n\t\t\t\tif (r.message) {\n\t\t\t\t\tcur_frm.set_value(\"due_date\", new Date(r.message));\n\t\t\t\t}\n\t        \t}\n\t\t});\n\t}\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Stock Entry", 
  "modified": "2017-07-29 02:06:26.296249", 
  "name": "Stock Entry-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "frappe.ui.form.on(\"Stock Entry\", \"refresh\", function(frm, cdt, cdn) {\n       \tfrm.add_custom_button(__(\"Get Items from Sales Order\"), function() {\n\t\tif (frm.doc.from_warehouse && frm.doc.to_warehouse && (frm.doc.purpose == \"Material Transfer\")) {\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"shei.sheipy.fetch_items_from_so\",\n\t\t\t\targs: {\n\t\t\t\t\tso: frm.doc.sales_order,\n\t\t\t\t},\n       \t    \t\t\tcallback: function(r) {\n\t\t\t\t\tif(!r.message) {\n\t\t\t\t\t\tfrappe.throw(__(\"Sales Order does not contain any stock item\"))\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$.each(r.message, function(item, value){\n\t\t\t\t\t\tvar d = frappe.model.add_child(cur_frm.doc, \"Stock Entry Detail\", \"items\");\n\t\t\t\t\t\td.item_code = item;\n\t\t\t\t\t\td.s_warehouse = frm.doc.from_warehouse;\n\t\t\t\t\t\td.t_warehouse = frm.doc.to_warehouse;\n\t\t\t\t\t\td.qty = value;\n\t\t\t\t\t\td.uom = 'Unit';\n\t\t\t\t\t\td.conversion_factor = 1;\n\t\t\t\t\t\td.transfer_qty = value;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tfrm.refresh_field(\"items\");\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tmsgprint(\"From and To warehouses are mandatory and Purpose must be Material Transfer\");\n\t\t}\n\t});\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Terms and Conditions Multilingual Extension", 
  "modified": "2017-08-23 21:06:49.010750", 
  "name": "Terms and Conditions Multilingual Extension-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "//frappe.ui.form.on(\"Terms and Conditions Multilingual Extension\", \"refresh\", function(frm, cdt, cdn) {\n//        frm.add_custom_button(__(\"Update Terms on customer\"), function() {\n//\t\tfrappe.call({\n//\t\t\tmethod: \"shei.sheipy.update_terms\",\n//\t\t\targs: {\n//\t\t\t},\n//\t    \t\tcallback: function(r) {\n//      \t\t\t}\n//\t\t})\n//\t});\n//});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Order", 
  "modified": "2019-04-10 11:28:44.380240", 
  "name": "Sales Order-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "frappe.ui.form.on('Sales Order', {\n    refresh: function(frm) {\n      frm.add_custom_button(__('Work Order'), function(){\n        var checked_items =  cur_frm.fields_dict.items.grid.get_selected_children().map(function(r){return r}); //list all checked instance\n\t\tfrappe.call({\n\t\t\tmethod: 'shei.events.create_work_order',\n\t\t\targs: {\n\t\t\t\tmfg_items : checked_items, \n\t\t\t\tso_name : frm.docname,\n\t\t\t},\n\t\t\tcallback: function() { }\n\t\t});\n\n    }, __(\"Make\"));\n  }\n});\n\n/*frappe.ui.form.on('Sales Order', {\n\tcreate_work_order: function(frm) {\n\t\tvar checked_items =  cur_frm.fields_dict.items.grid.get_selected_children().map(function(r){return r}); //list all checked instance\n\t\tfrappe.call({\n\t\t\tmethod: 'shei.events.create_work_order',\n\t\t\targs: {\n\t\t\t\tmfg_items : checked_items, \n\t\t\t\tso_name : frm.docname,\n\t\t\t},\n\t\t\tcallback: function() { }\n\t\t});\n\t},\n});*/\n\n\nfrappe.ui.form.on(\"Sales Order\", \"customer\", function(frm, cdt, cdn) {\n\tfrappe.db.get_value(\"Customer\", frm.doc.customer, \"tc_name\", function(r){\n\t\tif(r.tc_name) {\n\t\t\tfrappe.model.set_value(cdt, cdn, \"tc_name\", r.tc_name);\t\t\t\n\t\t}\n\t});\n\trefresh_field(\"tc_name\");\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Supplier", 
  "modified": "2017-11-15 12:28:36.607694", 
  "name": "Supplier-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "$.extend(erpnext.utils, {\n        set_party_dashboard_indicators: function(frm){\n                if (frm.doc.__onload && frm.doc.__onload.dashboard_info){\n                        var info = frm.doc.__onload.dashboard_info;\n                        frm.dashboard.add_indicator(__('Last Year Billing: {0}',\n                                [format_currency(info.billing_last_year, info.currency)]), 'blue')\n\t\t\tfrm.dashboard.add_indicator(__('This Year Billing: {0}',\n                                [format_currency(info.billing_this_year, info.currency)]), 'blue')\n                        frm.dashboard.add_indicator(__('Total Unpaid: {0}',\n                                [format_currency(info.total_unpaid, info.currency)]),\n                                info.total_unpaid ? 'orange': 'green');\n                }\n        }\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Bank Account", 
  "modified": "2018-11-07 14:39:40.573606", 
  "name": "Bank Account-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "frappe.ui.form.on('Bank Account', 'refresh', function(frm){\n    frm.set_query('deposit_account', function(doc){\n    return {\n\t'filters': {\n        \t'company': frm.doc.company\n\t}\n    }\n})\n})", 
  "script_type": "Client"
 }
]