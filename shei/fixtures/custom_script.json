[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Customer", 
  "modified": "2019-12-19 14:05:31.410887", 
  "name": "Customer-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "\n$.extend(erpnext.utils, {\n        set_party_dashboard_indicators: function(frm){\n                if (frm.doc.__onload && frm.doc.__onload.dashboard_info){\n                        var info = frm.doc.__onload.dashboard_info;\n                        frm.dashboard.add_indicator(__('Last Year Billing: {0}',\n                                [format_currency(info.billing_last_year, info.currency)]), 'blue')\n\t\t\tfrm.dashboard.add_indicator(__('This Year Billing: {0}',\n                                [format_currency(info.billing_this_year, info.currency)]), 'blue')\n                        frm.dashboard.add_indicator(__('Total Unpaid: {0}',\n                                [format_currency(info.total_unpaid, info.currency)]),\n                                info.total_unpaid ? 'orange': 'green');\n                }\n        }\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Quotation", 
  "modified": "2020-01-30 11:52:56.048150", 
  "name": "Quotation-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "frappe.ui.form.on('Quotation', {\n\trefresh: function(frm) {\n        \tfrm.add_custom_button(__(\"Toggle All Architectural Display ON\"), function() {\n\t\t\tfrm.doc.items.forEach(function(element) {\n\t\t\t\telement.architectural_display_price = 1;\n       \t\t\t});\n\t\t}, __(\"Architectural\"));\n\t\tfrm.add_custom_button(__(\"Toggle All Architectural Display OFF\"), function() {\n\t\t\tfrm.doc.items.forEach(function(element) {\n\t\t\t\telement.architectural_display_price = 0;\n       \t\t\t});\n\t\t}, __(\"Architectural\"));\n\t},\n});\nfrappe.ui.form.on('Price Configurator Item', {\n\tbefore_panel_list_remove: function(frm, cdt, cdn) {\n   \t    var deleted_row = frappe.get_doc(cdt, cdn);\n\t    var filtered = cur_frm.doc.items.filter(elem => elem['reference_panel'] == deleted_row['panel_id']);\n\t    filtered.forEach(function(element) {\n\t\tfrappe.model.remove_from_locals('Quotation Item', element.name);\n\t    });\n\t    refresh_field(\"items\");\n\t},\n\taluminum_item: function(frm, cdt, cdn){\n        var d = locals[cdt][cdn];\n        if (!d.aluminum_item) return;\n\t\tif(d.panel_id == null || d.panel_id.value.length == 0){\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"shei.sheipy.set_panel_uuid\",\n\t\t\t\targs:{},\n        \t\tcallback: function(r) {\n\t\t\t\tfrappe.model.set_value(cdt, cdn, \"panel_id\", r.message);\n\t\t\t}\n      \t\t})\n\t}\n    },\n});\nfrappe.ui.form.on(cur_frm.doctype, {\n    display_lost_reason: function(frm){\n        let dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Set as Lost\"),\n\t\t\tfields: [\n                                {\"fieldname\": 'lost_reason', 'fieldtype': 'Link',  'options': 'Lost Reason', 'reqd': 1},\n\t\t\t\t{'fieldname': 'other_reason', fieldtype: 'Small Text', label: __('Other Reason'), 'depends_on': \"eval:doc.lost_reason === 'RL0008'\"}\n\t\t\t],\n\t\t\tprimary_action: function() {\n\t\t\t\tvar values = dialog.get_values();\n\t\t\t\tlet reason_description = frappe.db.get_value(\"Lost Reason\", values[\"lost_reason\"], 'lost_reason');\n\t\t\t\t\n\t\t\t\treason_description.then(function(value){\n\t\t\t\t\tlet lost_reason = value['message']['lost_reason']\n\t\t\t\t\tlet full_reason = lost_reason;\n\t\t\t\t\tif(values[\"lost_reason\"] == 'RL0008'){\n\t\t\t\t\t\tif(values[\"other_reason\"] == null ){\n\t\t\t\t\t\t\tfrappe.throw(\"You must write a reason before proceeding\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tfull_reason = full_reason + \" - \" + values[\"other_reason\"];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfrm.call({\n\t\t\t\t\t\tmethod: 'declare_order_lost',\n\t\t\t\t\t\tdoc: frm.doc,\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t'reason': full_reason\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcallback: function(r) {\n\t\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\t\tfrm.reload_doc();\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\trefresh_field(\"quote_lost_reason\");\n\t\t\t\t});\n\t\t\t},\n\t\t\tprimary_action_label: __('Declare Lost')\n\t\t});\n\n\t\tdialog.show();\n\t\tdialog.get_input('lost_reason').on('awesomplete-selectcomplete', function(e){\n\t\t\tsetTimeout(function(){\n        \t\t\tdialog.refresh();\n    \t\t\t}, 500);\n\t\t});\n    }\n});\n\n//Will overwrite the QuotationController - used to change 'Set as lost' button behavior\nerpnext.selling.CustomQuotationController = erpnext.selling.QuotationController.extend({\n    refresh: function(doc, dt, dn) {\n\t\tthis._super(doc, dt, dn);\n\t\t//the button should only be available if the quote is 'Submit'\n\t\tif(doc.docstatus == 1 && doc.status!=='Lost') {\n\t\t\tif(doc.status!==\"Ordered\") {\n\t\t\t\tthis.frm.remove_custom_button(__('Set as Lost'));\n\t\t\t\tthis.frm.add_custom_button(__('Set as Lost'), () => {\n\t\t\t\t\tthis.frm.trigger('display_lost_reason');\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n});\ncur_frm.script_manager.make(erpnext.selling.CustomQuotationController);\n\n/* frappe.ui.form.on('Quotation', 'refresh', function(frm, cdt, cdn){\n\tif (!frm.doc.__islocal){\n\t\tdashboard_link_doctype(frm, 'Product Configurator', __('Sales Order'), {  //sales order = where the link should be displayed\n\t\t\t'fieldname': 'quote',\n\t\t\t'transactions': [\n\t\t\t\t{\n\t\t\t\t\t'items': ['Product Configurator'],\n\t\t\t\t\t'label': __('Product Configurator')\n\t\t\t\t}]\n\t\t});\n\t}\n});\n\nfunction dashboard_link_doctype(frm, doctype, section, links){\n\tdebugger;\n\tvar parent = $(format('.form-dashboard-wrapper h6:contains(\"{}\")', [section])).parent();\n\tparent.find(format('div.document-link[data-doctype=\"{}\"]', [doctype])).remove();\n\tparent.append(frappe.render_template('dashboard_link_doctype', {'doctype': doctype}));\n\tvar self = parent.find(format('div.document-link[data-doctype=\"{}\"]', [doctype]));\n\tset_open_count(frm, doctype, links);\n\t// bind links\n\tself.find('.badge-link').on('click', function(){\n\t\tvar routes = {};\n\t\troutes[frappe.scrub(frm.doc.doctype)] = frm.doc.name;\n\t\tfrappe.route_options = routes;\n\t\tfrappe.set_route('List', doctype);\n\t});\n\n\t// bind open notifications\n\tself.find('.open-notification').on('click', function() {\n\t\tfrappe.route_options = {\n\t\t\t'product_configurator': frm.doc.name//,\n\t\t\t//'status': 'Draft'\n\t\t};\n\t\tfrappe.set_route('List', doctype);\n\t});\n}\n\nfunction set_open_count (frm, doctype, links){\n\tfrappe.call({\n\t\t'method': 'shei.api.get_open_count',\n\t\t'args': {\n\t\t\t'doctype': frm.doctype,\n\t\t\t'name': frm.docname,\n\t\t\t'links': links\n\t\t},\n\t\t'callback': function(res){\n\t\t\t// update badges\n\t\t\tif (res && res.message){\n\t\t\t\tres.message.count.forEach(function(d){\n\t\t\t\t\tfrm.dashboard.set_badge_count(\n\t\t\t\t\t\td.name, cint(d.open_count), cint(d.count)\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n}\n*/\n\n\n\n\n\n\n\n    frappe.ui.form.on(\"Quotation\", \"customer_deposit\", function(frm, cdt, cdn) {\n\tif(frm.doc.customer_deposit == 1)\n\t\t{\n\t\tfrappe.model.set_value(cdt, cdn, \"naming_series\", \"PFI-\");\n\t}\n\telse\n\t\t{\n\t\tfrappe.model.set_value(cdt, cdn, \"naming_series\", \"QTN-\");\n\t}\n});\n\nfrappe.ui.form.on(\"Quotation\", \"customer\", function(frm, cdt, cdn) {\n\tfrappe.db.get_value(\"Customer\", frm.doc.customer, \"tc_name\", function(r){\n\t\tif(r.tc_name) {\n\t\t\tfrappe.model.set_value(cdt, cdn, \"tc_name\", r.tc_name);\t\t\t\n\t\t}\n\t});\n\trefresh_field(\"tc_name\");\n}); \n\nfrappe.ui.form.on(\"Quotation\", \"refresh\", function(frm, cdt, cdn) {\n\n        frm.add_custom_button(__(\"Update Item Description\"), function() {\n\t\tfrappe.call({\n\t\t\tmethod: \"multilingual_extension.item_description.update_item_description\",\n\t\t\targs: {\n\t\t\t\tcustomer: frm.doc.customer,\n\t\t\t\tdocType: \"Quotation\",\n\t\t\t\tdocName: frm.doc.name,\n\t\t\t},\n\t    \t\tcallback: function(r) {\n\t\t\t\tcur_frm.reload_doc();\n      \t\t\t}\n\t\t})\n\t});\n});\n\n//frappe.ui.form.on(\"Quotation Item\", \"item_code\", function(frm, cdt, cdn) {\n//\tct = locals[cdt][cdn]\n//\tfrappe.after_ajax(function() {\n//\t\tfrappe.call({\n//\t\t\tmethod: \"multilingual_extension.item_description.fetch_item_description\",\n//\t\t\targs:{\n//\t\t\t\tcustomer_code: frm.doc.customer,\n//\t\t\t\titem_code: ct.item_code,\n//\t\t\t\t},\n//            \tcallback: function(r) {\n//\t\t\tfrappe.model.set_value(cdt, cdn, \"description\", r.message);\n//\t\t\t}\n//        \t})\n//\t});\n//});\n\n//frappe.ui.form.on(\"Quotation\", \"customer\", function(frm, cdt, cdn) {\n//\t\tfrappe.call({\n//\t\t\tmethod: \"multilingual_extension.get_terms_and_conditions.get_terms_and_conditions\",\n//\t\t\targs:{\n//\t\t\t\tcustomer_code: frm.doc.customer\n//\t\t\t\t},\n//            \tcallback: function(r) {\n//\t\t\tif (r.message != \" \") {\n//\t\t\t\tfrappe.model.set_value(cdt, cdn, \"tc_name\", r.message);\n//\t\t\t}\n//        \t    }\n//\t});\n//});\n\n//frappe.ui.form.on(\"Quotation\", \"validate\", function(frm, cdt, cdn){\n//\tif (frm.doc.customer_deposit && !frm.doc.project) {\n//\t\tmsgprint(__(\"Project is mandatory when Customer Deposit is selected\"));\n//\t\tvalidated = false;\n//\t}\n//});\n\nfrappe.ui.form.on(\"Quotation\", \"on_submit\", function(frm, cdt, cdn){\n\tif (frm.doc.customer_deposit && frm.doc.project) {\n\t\tfrappe.call({\n\t\t\tmethod: \"shei.sheipy.set_project_pfi\",\n\t\t\targs:{\n\t\t\t\tpfi: frm.doc.name,\n\t\t\t\taction: \"add\"\n\t\t\t},\n\t            \tcallback: function(r) {\n\t        \t}\n\t\t});\n\t}\n\tif (frm.doc.customer_deposit && !frm.doc.project) {\n\t\tfrappe.throw(__(\"Project is mandatory when Customer Deposit is selected\"));\n\t}\n});\n\nfrappe.ui.form.on(\"Quotation\", \"after_cancel\", function(frm, cdt, cdn){\n\tif (frm.doc.customer_deposit && frm.doc.project) {\n\t\tfrappe.call({\n\t\t\tmethod: \"shei.sheipy.set_project_pfi\",\n\t\t\targs:{\n\t\t\t\tpfi: frm.doc.name,\n\t\t\t\taction: \"remove\"\n\t\t\t},\n\t            \tcallback: function(r) {\n\t        \t}\n\t\t});\n\t}\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Invoice", 
  "modified": "2019-12-17 11:15:45.495929", 
  "name": "Sales Invoice-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "\n\n\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Payment Entry", 
  "modified": "2019-12-17 11:11:06.119392", 
  "name": "Payment Entry-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Project", 
  "modified": "2019-12-17 11:17:05.339407", 
  "name": "Project-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "frappe.ui.form.on('Project Task', {\n    status: function(frm, cdt, cdn){\n        var d = locals[cdt][cdn];\n        if (!d.status) return;\n\tif(d.status == \"Closed\"){\n\t        frappe.model.set_value(cdt, cdn, 'end_date', frappe.datetime.get_today());\n\t}\n    }\n});\n\nfrappe.ui.form.on('Crate Information', {\n    crate_gross_weight: function(frm, cdt, cdn){\n        var d = locals[cdt][cdn];\n        if (!d.crate_gross_weight) return;\n        frappe.model.set_value(cdt, cdn, 'crate_net_weight', d.crate_gross_weight - 100);\n    }\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Purchase Invoice", 
  "modified": "2019-12-17 11:10:14.249581", 
  "name": "Purchase Invoice-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Stock Entry", 
  "modified": "2019-12-17 11:09:38.429338", 
  "name": "Stock Entry-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Terms and Conditions Multilingual Extension", 
  "modified": "2019-12-17 11:08:30.735238", 
  "name": "Terms and Conditions Multilingual Extension-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Order", 
  "modified": "2019-12-17 10:26:45.901914", 
  "name": "Sales Order-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Supplier", 
  "modified": "2017-11-15 12:28:36.607694", 
  "name": "Supplier-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "$.extend(erpnext.utils, {\n        set_party_dashboard_indicators: function(frm){\n                if (frm.doc.__onload && frm.doc.__onload.dashboard_info){\n                        var info = frm.doc.__onload.dashboard_info;\n                        frm.dashboard.add_indicator(__('Last Year Billing: {0}',\n                                [format_currency(info.billing_last_year, info.currency)]), 'blue')\n\t\t\tfrm.dashboard.add_indicator(__('This Year Billing: {0}',\n                                [format_currency(info.billing_this_year, info.currency)]), 'blue')\n                        frm.dashboard.add_indicator(__('Total Unpaid: {0}',\n                                [format_currency(info.total_unpaid, info.currency)]),\n                                info.total_unpaid ? 'orange': 'green');\n                }\n        }\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Bank Account", 
  "modified": "2019-12-17 11:07:48.475246", 
  "name": "Bank Account-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Delivery Note", 
  "modified": "2019-06-27 17:39:03.537978", 
  "name": "Delivery Note-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "/*frappe.ui.form.on('Crate Information', {\n    crate_gross_weight: function(frm, cdt, cdn){\n        var d = locals[cdt][cdn];\n        if (!d.crate_gross_weight) return;\n        frappe.model.set_value(cdt, cdn, 'crate_net_weight', d.crate_gross_weight - 100);\n    }\n});*/", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Address", 
  "modified": "2019-12-16 13:50:21.592041", 
  "name": "Address-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "", 
  "script_type": "Client"
 }
]